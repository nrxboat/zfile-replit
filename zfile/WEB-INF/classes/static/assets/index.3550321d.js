import{bu as j,A as G}from"./base.f9e60852.js";/* empty css                */import{Z as J,a as Q}from"./ZFormItem.91aded87.js";/* empty css              */import"./tooltip.f118fcb0.js";import{E as H}from"./popper.819708f8.js";import{E as K}from"./image-viewer.31c03c26.js";/* empty css               */import{E as O}from"./radio.bdc7b396.js";import{E as W}from"./switch.9f84dbfb.js";import{d as X,v as x,l as Y,e as $}from"./admin-setting.c62e8d8e.js";import{r as ee,as as h,w as F,u as e,J as oe,a as m,b as v,e as n,L as l,j as i,E as I,f as T,k,Q as te,R as ne,m as b}from"./index.f20a2340.js";import{t as ae}from"./vue3-clipboard.esm-bundler.34366eba.js";import{E as _}from"./request.29c9df35.js";import{E as R}from"./index.e487e6de.js";import{b as L}from"./route-block.9b0645f8.js";import{_ as le}from"./plugin-vue_export-helper.21dcd24c.js";import{E as ie}from"./index.2085544e.js";import{v as re}from"./directive.eb3ba7ee.js";import"./index.5cf4e3bb.js";import"./focus-trap.7aeb3cb3.js";import"./debounce.0dcbc4e4.js";import"./scroll.5771f43f.js";import"./event.776e7e11.js";import"./validator.02bde218.js";import"./index.b60e2a18.js";const y=ee({});function se(){const{data:s,reload:o}=h(Y,{formatResult:t=>t.data}),{loading:u,run:g}=h($,{manual:!0,onSuccess(){_({message:"\u4FDD\u5B58\u6210\u529F",type:"success"})}}),f=()=>{g(s.value)},d=()=>{X().then(t=>{y.value=t.data})};return{data:s,reload:o,saveData:f,saveLoading:u,load2FAInfo:d,twoFAData:y,copyTwoFASecret:()=>{ae(y.value.secret).then(()=>{_.success("\u590D\u5236\u6210\u529F")})},verifyCodeAndBind:()=>{x(y.value).then(t=>{_.success("\u7ED1\u5B9A\u6210\u529F"),o()})},rebind:()=>{s.value.loginVerifySecret="",d()},cancelBind:()=>{R.confirm("\u662F\u5426\u786E\u8BA4\u53D6\u6D88\u7ED1\u5B9A\uFF0C\u786E\u8BA4\u540E\u5C06\u81EA\u52A8\u6062\u590D\u4E3A\u56FE\u5F62\u9A8C\u8BC1\u7801","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"success",callback:t=>{t==="confirm"&&(s.value.loginVerifySecret="",s.value.loginVerifyMode="image")}})},validBind:()=>{R.prompt("\u8BF7\u8F93\u5165\u53CC\u56E0\u7D20\u8BA4\u8BC1 APP \u4E2D\u7684\u9A8C\u8BC1\u7801","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",inputValidator(t){return!!t},inputErrorMessage:"\u9A8C\u8BC1\u7801\u4E0D\u80FD\u4E3A\u7A7A."}).then(({value:t})=>{let a={secret:s.value.loginVerifySecret,code:t};x(a).then(()=>{_.success("\u9A8C\u8BC1\u6210\u529F")})})}}}const S=s=>(te("data-v-7666d571"),s=s(),ne(),s),de=S(()=>b("b",null,"Google \u8EAB\u4EFD\u9A8C\u8BC1\u5668",-1)),ce=S(()=>b("b",null,"Microsoft Authenticator",-1)),me=S(()=>b("br",null,null,-1)),ue={key:0,class:"w-full"},fe={key:1},q={__name:"index",setup(s){const{data:o,saveData:u,saveLoading:g,load2FAInfo:f,twoFAData:d,copyTwoFASecret:B,verifyCodeAndBind:C,rebind:E,cancelBind:w,validBind:A}=se();return F(()=>{var t;return(t=o.value)==null?void 0:t.loginVerifyMode},(t,a)=>{(t==="off"||t==="image")&&a&&u(),t==="2fa"&&!o.value.loginVerifySecret&&f()}),F(()=>{var t;return(t=o.value)==null?void 0:t.showLogin},(t,a)=>{t!==a&&a!==void 0&&u()}),(t,a)=>{const D=W,p=J,V=O,c=G,U=K,z=H,M=ie,N=Q,Z=re;return e(o)?oe((m(),v(N,{key:0,model:e(o)},{"form-title":n(()=>[l(" \u5B89\u5168\u8BBE\u7F6E ")]),"form-sub-title":n(()=>[l(" \u6B64\u5904\u8BBE\u7F6E\u53EF\u4FDD\u62A4\u60A8\u7684\u7AD9\u70B9\u5B89\u5168 ")]),default:n(()=>[i(p,{label:"\u662F\u5426\u663E\u793A\u767B\u5F55\u5165\u53E3"},{tips:n(()=>[l(" \u542F\u7528\u540E\uFF0C\u4F1A\u5728\u95E8\u6237\u663E\u793A\u540E\u53F0\u767B\u5F55\u5165\u53E3\uFF0C\u8BF7\u6839\u636E\u81EA\u8EAB\u60C5\u51B5\u9009\u62E9\u662F\u5426\u542F\u7528 ")]),default:n(()=>[i(D,{modelValue:e(o).showLogin,"onUpdate:modelValue":a[0]||(a[0]=r=>e(o).showLogin=r)},null,8,["modelValue"])]),_:1}),i(p,{label:"\u767B\u5F55\u9A8C\u8BC1\u65B9\u5F0F"},I({default:n(()=>[i(V,{modelValue:e(o).loginVerifyMode,"onUpdate:modelValue":a[1]||(a[1]=r=>e(o).loginVerifyMode=r),label:"off"},{default:n(()=>[l("\u4E0D\u542F\u7528\u767B\u5F55\u9A8C\u8BC1")]),_:1},8,["modelValue"]),i(V,{modelValue:e(o).loginVerifyMode,"onUpdate:modelValue":a[2]||(a[2]=r=>e(o).loginVerifyMode=r),label:"image"},{default:n(()=>[l("\u542F\u7528\u56FE\u7247\u9A8C\u8BC1\u7801")]),_:1},8,["modelValue"]),i(V,{modelValue:e(o).loginVerifyMode,"onUpdate:modelValue":a[3]||(a[3]=r=>e(o).loginVerifyMode=r),label:"2fa"},{default:n(()=>[l("\u542F\u7528\u53CC\u56E0\u7D20\u8BA4\u8BC1")]),_:1},8,["modelValue"])]),_:2},[e(o).loginVerifyMode==="image"?{name:"tips",fn:n(()=>[l(" \u56FE\u7247\u9A8C\u8BC1\u7801\u4E5F\u53EF\u80FD\u4F1A\u88AB\u8BC6\u522B\uFF0C\u4E0D\u80FD\u5B8C\u5168\u62B5\u6321\u66B4\u529B\u7834\u89E3\u3002 ")]),key:"0"}:void 0,e(o).loginVerifyMode==="2fa"?{name:"tips",fn:n(()=>[l(" \u53CC\u56E0\u7D20\u8BA4\u8BC1\u53EF\u5B8C\u7F8E\u4FDD\u62A4\u767B\u5F55\u8BA4\u8BC1\uFF0C\u53EF\u4F7F\u7528\u4EFB\u610F\u652F\u6301 2FA \u8BA4\u8BC1\u7684\u8F6F\u4EF6\uFF0C\u5982 "),de,l("\u3001"),ce,l(" \u7B49\u8F6F\u4EF6. "),me]),key:"1"}:void 0]),1024),e(o).loginVerifyMode==="2fa"?(m(),v(p,{key:0,label:"\u53CC\u56E0\u7D20\u8BA4\u8BC1\u5BC6\u94A5"},I({default:n(()=>{var r;return[e(o).loginVerifySecret?(m(),T("div",ue,[i(c,{size:"small",type:"primary",onClick:e(E)},{default:n(()=>[l("\u91CD\u65B0\u7ED1\u5B9A")]),_:1},8,["onClick"]),i(c,{size:"small",type:"primary",onClick:e(w)},{default:n(()=>[l("\u53D6\u6D88\u7ED1\u5B9A")]),_:1},8,["onClick"]),i(c,{size:"small",type:"primary",onClick:e(A)},{default:n(()=>[l("\u9A8C\u8BC1\u7ED1\u5B9A")]),_:1},8,["onClick"])])):(m(),T("div",fe,[i(U,{onClick:e(f),src:(r=e(d))==null?void 0:r.qrcode},null,8,["onClick","src"]),i(M,{readonly:"",modelValue:e(d).secret,"onUpdate:modelValue":a[4]||(a[4]=P=>e(d).secret=P)},{append:n(()=>[i(z,{class:"item",effect:"dark",content:"\u590D\u5236",placement:"bottom"},{default:n(()=>[i(c,{onClick:e(B),icon:e(j)},null,8,["onClick","icon"])]),_:1})]),_:1},8,["modelValue"])]))]}),_:2},[e(o).loginVerifySecret?void 0:{name:"tips",fn:n(()=>[l(" \u53EF\u626B\u63CF\u4E0A\u65B9\u4E8C\u7EF4\u7801\u6216\u590D\u5236\u4E0B\u65B9\u5BC6\u94A5\u5230\u652F\u6301\u53CC\u56E0\u7D20\u8BA4\u8BC1\u7684\u8F6F\u4EF6\u4E2D\u6DFB\u52A0\u3002 ")]),key:"0"}]),1024)):k("",!0),e(o).loginVerifyMode==="2fa"&&!e(o).loginVerifySecret?(m(),v(p,{key:1,label:"\u53CC\u56E0\u7D20\u8BA4\u8BC1\u9A8C\u8BC1\u7801"},{tips:n(()=>[l(" \u8BF7\u7ED1\u5B9A\u53CC\u56E0\u7D20\u8BA4\u8BC1\u8F6F\u4EF6\u540E\uFF0C\u8F93\u5165\u663E\u793A\u7684\u9A8C\u8BC1\u7801\u8FDB\u884C\u7ED1\u5B9A ")]),default:n(()=>[i(M,{modelValue:e(d).code,"onUpdate:modelValue":a[5]||(a[5]=r=>e(d).code=r)},null,8,["modelValue"]),i(c,{onClick:e(C),type:"primary"},{default:n(()=>[l("\u9A8C\u8BC1\u5E76\u7ED1\u5B9A")]),_:1},8,["onClick"])]),_:1})):k("",!0)]),_:1},8,["model"])),[[Z,e(g)]]):k("",!0)}}};typeof L=="function"&&L(q);var Ne=le(q,[["__scopeId","data-v-7666d571"]]);export{Ne as default};
