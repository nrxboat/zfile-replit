var E=Object.defineProperty,P=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var h=(t,e,l)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[e]=l,m=(t,e)=>{for(var l in e||(e={}))O.call(e,l)&&h(t,l,e[l]);if(k)for(var l of k(e))R.call(e,l)&&h(t,l,e[l]);return t},p=(t,e)=>P(t,j(e));var w=(t,e,l)=>new Promise((n,s)=>{var a=d=>{try{c(l.next(d))}catch(r){s(r)}},u=d=>{try{c(l.throw(d))}catch(r){s(r)}},c=d=>d.done?n(d.value):Promise.resolve(d.value).then(a,u);c((l=l.apply(t,e)).next())});import{a as $,aj as x,Q as z,k as B,J,ak as g,ah as _,ab as I,az as K}from"./base.f9e60852.js";import{a7 as M,r as N,M as Z,ai as q,ab as b,e as D,J as F,j as H,K as Q,T as W,P as S,W as Y}from"./index.f20a2340.js";function G(t){let e;const l=$("loading"),n=N(!1),s=Z(p(m({},t),{originalPosition:"",originalOverflow:"",visible:!1}));function a(o){s.text=o}function u(){const o=s.parent;if(!o.vLoadingAddClassList){let v=o.getAttribute("loading-number");v=Number.parseInt(v)-1,v?o.setAttribute("loading-number",v.toString()):(x(o,l.bm("parent","relative")),o.removeAttribute("loading-number")),x(o,l.bm("parent","hidden"))}c(),f.unmount()}function c(){var o,v;(v=(o=i.$el)==null?void 0:o.parentNode)==null||v.removeChild(i.$el)}function d(){var o;t.beforeClose&&!t.beforeClose()||(n.value=!0,clearTimeout(e),e=window.setTimeout(r,400),s.visible=!1,(o=t.closed)==null||o.call(t))}function r(){if(!n.value)return;const o=s.parent;n.value=!1,o.vLoadingAddClassList=void 0,u()}const f=q({name:"ElLoading",setup(){return()=>{const o=s.spinner||s.svg,v=b("svg",m({class:"circular",viewBox:s.svgViewBox?s.svgViewBox:"0 0 50 50"},o?{innerHTML:o}:{}),[b("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),V=s.text?b("p",{class:l.b("text")},[s.text]):void 0;return b(W,{name:l.b("fade"),onAfterLeave:r},{default:D(()=>[F(H("div",{style:{backgroundColor:s.background||""},class:[l.b("mask"),s.customClass,s.fullscreen?"is-fullscreen":""]},[b("div",{class:l.b("spinner")},[v,V])]),[[Q,s.visible]])])})}}}),i=f.mount(document.createElement("div"));return p(m({},M(s)),{setText:a,removeElLoadingChild:c,close:d,handleAfterLeave:r,vm:i,get $el(){return i.$el}})}let y;const U=function(t={}){if(!z)return;const e=X(t);if(e.fullscreen&&y)return y;const l=G(p(m({},e),{closed:()=>{var s;(s=e.closed)==null||s.call(e),e.fullscreen&&(y=void 0)}}));ee(e,e.parent,l),A(e,e.parent,l),e.parent.vLoadingAddClassList=()=>A(e,e.parent,l);let n=e.parent.getAttribute("loading-number");return n?n=`${Number.parseInt(n)+1}`:n="1",e.parent.setAttribute("loading-number",n),e.parent.appendChild(l.$el),S(()=>l.visible.value=e.visible),e.fullscreen&&(y=l),l},X=t=>{var e,l,n,s;let a;return B(t.target)?a=(e=document.querySelector(t.target))!=null?e:document.body:a=t.target||document.body,{parent:a===document.body||t.body?document.body:a,background:t.background||"",svg:t.svg||"",svgViewBox:t.svgViewBox||"",spinner:t.spinner||!1,text:t.text||"",fullscreen:a===document.body&&((l=t.fullscreen)!=null?l:!0),lock:(n=t.lock)!=null?n:!1,customClass:t.customClass||"",visible:(s=t.visible)!=null?s:!0,target:a}},ee=(t,e,l)=>w(void 0,null,function*(){const{nextZIndex:n}=J(),s={};if(t.fullscreen)l.originalPosition.value=g(document.body,"position"),l.originalOverflow.value=g(document.body,"overflow"),s.zIndex=n();else if(t.parent===document.body){l.originalPosition.value=g(document.body,"position"),yield S();for(const a of["top","left"]){const u=a==="top"?"scrollTop":"scrollLeft";s[a]=`${t.target.getBoundingClientRect()[a]+document.body[u]+document.documentElement[u]-Number.parseInt(g(document.body,`margin-${a}`),10)}px`}for(const a of["height","width"])s[a]=`${t.target.getBoundingClientRect()[a]}px`}else l.originalPosition.value=g(e,"position");for(const[a,u]of Object.entries(s))l.$el.style[a]=u}),A=(t,e,l)=>{const n=$("loading");["absolute","fixed","sticky"].includes(l.originalPosition.value)?x(e,n.bm("parent","relative")):_(e,n.bm("parent","relative")),t.fullscreen&&t.lock?_(e,n.bm("parent","hidden")):x(e,n.bm("parent","hidden"))},L=Symbol("ElLoading"),T=(t,e)=>{var l,n,s,a;const u=e.instance,c=i=>I(e.value)?e.value[i]:void 0,d=i=>{const o=B(i)&&(u==null?void 0:u[i])||i;return o&&N(o)},r=i=>d(c(i)||t.getAttribute(`element-loading-${K(i)}`)),C=(l=c("fullscreen"))!=null?l:e.modifiers.fullscreen,f={text:r("text"),svg:r("svg"),svgViewBox:r("svgViewBox"),spinner:r("spinner"),background:r("background"),customClass:r("customClass"),fullscreen:C,target:(n=c("target"))!=null?n:C?void 0:t,body:(s=c("body"))!=null?s:e.modifiers.body,lock:(a=c("lock"))!=null?a:e.modifiers.lock};t[L]={options:f,instance:U(f)}},te=(t,e)=>{for(const l of Object.keys(e))Y(e[l])&&(e[l].value=t[l])},ae={mounted(t,e){e.value&&T(t,e)},updated(t,e){const l=t[L];e.oldValue!==e.value&&(e.value&&!e.oldValue?T(t,e):e.value&&e.oldValue?I(e.value)&&te(e.value,l.options):l==null||l.instance.close())},unmounted(t){var e;(e=t[L])==null||e.instance.close()}};export{U as L,ae as v};
